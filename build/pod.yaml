apiVersion: v1
kind: Pod
metadata:
  name: moneybook-pod
spec:
  restartPolicy: Always
  containers:
  - name: gunicorn
    image: localhost/moneybook_gunicorn:${BUILD_TAG}
    env:
    - name: DB_NAME
      value: "${DB_NAME}"
    - name: DB_USER
      value: "${DB_USER}"
    - name: DB_PASS
      value: "${DB_PASS}"
    - name: DB_HOST
      value: "${DB_HOST}"
    - name: HOST_NAME
      value: "${HOST_NAME}"
    - name: SECRET_KEY
      value: "${SECRET_KEY}"
    - name: STATIC_VERSION
      value: "${STATIC_VERSION}"
    ports:
    - containerPort: 8081
      protocol: TCP
    
  - name: nginx
    image: localhost/moneybook_nginx:${BUILD_TAG}
    ports:
    - containerPort: 80
      hostPort: 8081
      protocol: TCP
